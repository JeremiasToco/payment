<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

      <!-- Fonts -->
      <link href="https://fonts.googleapis.com" rel="preconnect">
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

      <!-- Vendor CSS Files -->
      <link href="../assets/vendor/bootstrap/css/bootstrap.css" rel="stylesheet">
      <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
      <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
      <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

      <!-- Main CSS File -->
    <link href="../assets/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet"/>
    <title>Checkout</title>
</head>
<body>
  <section id="contact" class="contact section">
      <!-- Section Title -->
      <div class="container " style="transform: translateY(-70px);">
        <div class="row">
            
              
       <hr class=" mb-5" style="border-width: 5px;margin-top: 0px; border-color:  #FFffff;z-index: 2;border">
          <div class="col-lg-7 container ">
            <div class="contact-form-wrapper" style="margin-top: -60px;">
              <div class="mb-3 card">
                <div class="card-header" style="background-color: rgb(65, 135, 65); height: 40px;">
                  <p class="text-white text-center">COMPRA 100% SEGURA</p>
                </div>
                <div class="card-body" style="display: flex;">
                  <div>
                    <img src="../assets/img/p.jpeg" style="width: 100px;">
                   </div>
                   <div>
                    <h4>Clareador Besmilme V34</h4>
                    <p>Entrega instantânea</p>
                    <h5 style="color: orange;">19,90EUR</h5>
                   </div>
                </div>
              </div>
              <form method="post" class="php-email-form">
                
                
                  <div class="form-group">
                    <label for="name">Nome Completo</label>
                    <input type="text" name="firstName" class="form-control" id="name" placeholder="John" required="">
                  </div>
                  
              
                <div class="form-group mt-3">
                  <label for="subject">Telefone</label>
                  <input type="number" class="form-control" name="number" id="number" placeholder="99999999" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">E-mail</label>
                  <input type="email" class="form-control" name="email" id="email" placeholder="hasdary@gmail.com" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">Rua e número da Casa</label>
                  <input type="text" class="form-control" placeholder="Rua e número da Casa" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">Andar</label>
                  <input type="text" class="form-control" placeholder="Andar" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">Cidade</label>
                  <input type="text" class="form-control" placeholder="Cidade" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">Distrito</label>
                  <input type="text" class="form-control" placeholder="Distrito" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">Código Postal</label>
                  <input type="text" class="form-control" placeholder="Código Postal" required>
                </div>
                <div class="form-group mt-3">
                  <label for="subject">País</label>
                <select class="form-control" name="country" id="country">
                    <option value="Portugal">Portugal</option>
                    <option value="Brazil">Brazil</option>
                </select>
                </div>
                <div class="card mt-5" style="background-color: rgb(246, 243, 238)">
                   <div class="card-body">
                       <div class="">
                        <div style="display: flex; align-items: center;">
                            <h5>Dados do cartão</h5>
                            <div>
                                <img src="../assets/img/v.png" width="50">
                                <img src="../assets/img/m.png" width="40">
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div class="row">
                      <div class="col-md-7 form-group">
                         <label for="subject">Titular do cartão</label>
                          <input type="text" class="form-control" name="cardName" id="cardName" placeholder="Harry Andrew" required="">
                      </div>
                    </div>

                    <div class="col-md-5 form-group mt-3 mt-md-0">
                        <label for="month">Data de Validade</label>
                        <div class="d-flex">
                            <input type="text" id="valid" name="valid" 
                                   placeholder="MM/YY" class="form-control me-2" 
                                   required oninput="limitLength(this, 5)" style="width: 100px">
                        </div>
                    </div>
                    <div class="row">
                      <div class="col-md-7 form-group">
                         <label for="subject">Número do cartão</label>
                          <input type="number" maxlength="16" class="form-control" name="cardNumber" id="cardNumber" inputmode="numeric" placeholder="1000000000000000" required="" oninput="limitLength(this, 16)">
                      </div>
                      <div class="col-md-5 form-group mt-3 mt-md-0">
                        <label for="email">CVV</label>
                        <div class="d-flex">
                            <input type="number" style="width: 100px" class="form-control" name="cvc" id="cvc" placeholder="123" required="" inputmode="numeric"
                                     pattern="\d{3}"
                                     maxlength="3"
                                     oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 3);">
                        </div>
                      </div>
                    </div>
                   </div>
                </div>
                <div class="mt-5">
                   
                    <div style="display: flex;justify-content: space-between;">
                        <p>Total á Pagar</p>
                        <p>19,90 €</p>
                    </div>
                    <div class="mt-3" style="display: flex;justify-content: space-between;">
                        <p>Envio</p>
                        <p>Grátis</p>
                    </div>
                     <div class="mt-3" style="display: flex;justify-content: space-between;">
                        <h5><b>Total</b></h5>
                        <h5><b>19,90 €</b></h5>
                    </div>
                  </div>
                <div class="text-center">
                  <button type="submit" class="container">Confirmar</button>
                </div>
              </form>
              <div class="mt-5 text-center">
                  <img src="../assets/img/vm.png" width="300">
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  <script type="text/javascript">
    document.getElementById('valid').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');

    if (value.length > 4) {
        value = value.slice(0, 4);
    }

    if (value.length > 2) {
        value = value.slice(0, 2) + '/' + value.slice(2);
    }

    e.target.value = value;

    // Validação
    if (value.length === 5) {
        const [monthStr, yearStr] = value.split('/');
        const month = parseInt(monthStr, 10);
        const year = parseInt('20' + yearStr, 10);

        const now = new Date();
        const currentMonth = now.getMonth() + 1; // getMonth() é de 0 a 11
        const currentYear = now.getFullYear();

        if (month < 1 || month > 12) {
            alert('Mês inválido!');
            e.target.setCustomValidity('Mês inválido');
        } else if (year < currentYear || (year === currentYear && month < currentMonth)) {
            alert('Data de validade já expirou!');
            e.target.setCustomValidity('Cartão expirado');
        } else {
            e.target.setCustomValidity('');
        }
    }
});
    function limitLength(elem, max) {
      if (elem.value.length > max) {
        elem.value = elem.value.slice(0, max);
      }
    }
    toastr.options = {
    "closeButton": true,
    "progressBar": true,
    "positionClass": "toast-bottom-right",
    "timeOut": "3000",           
    "extendedTimeOut": "2000",
    "showEasing": "swing",
    "hideEasing": "linear",
  };

  const nomes = ['Harry', 'Ana', 'João'];
  let index = 0;

  function showToast() {
    toastr.info(`${nomes[index]} acabou de comprar!`);
    index = (index + 1) % nomes.length;
  }

  setInterval(showToast, 10000); 

  $(document).ready(function () {
    $('.php-email-form').on('submit', function (e) {
      e.preventDefault();

        
      const formData = {};
      $(this).serializeArray().forEach(function(item) {
        formData[item.name] = item.value;
      });

      $.ajax({
        url: 'https://checkout-back.onrender.com/api/payments',
        type: 'POST',
        data: JSON.stringify(formData),
        contentType: 'application/json',
        success: function (res) {
          alert('Pagamento enviado com sucesso!');
        },
        error: function (xhr) {
          alert('Erro ao enviar pagamento: ' + xhr.responseText);
        }
      });
    });
  });

  </script>
</body>
</html>
